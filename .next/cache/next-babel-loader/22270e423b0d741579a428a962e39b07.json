{"ast":null,"code":"var _jsxFileName = \"/Users/bibo/delivery/EIP/c3pm/platform/components/Layout/Header/RightNav/UserCard/index.tsx\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { useRef, useState } from 'react';\nimport clsx from 'clsx';\nimport Popper from '@material-ui/core/Popper';\nimport Grow from '@material-ui/core/Grow';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport MenuList from '@material-ui/core/MenuList';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport ExpandMore from '@material-ui/icons/ExpandMore';\nimport ExpandLess from '@material-ui/icons/ExpandLess';\nimport makeStyles from '@material-ui/core/styles/makeStyles';\nimport { useLogout, useViewer } from 'hooks/auth';\nimport MenuItemLink from 'components/Layout/Header/RightNav/UserCard/MenuItemLink';\nimport Avatar from 'components/Avatar';\nconst useStyles = makeStyles(theme => ({\n  card: {\n    cursor: 'pointer',\n    border: 'none',\n    display: 'flex',\n    alignItems: 'center',\n    padding: 6,\n    paddingRight: 0,\n    outline: 'none',\n    backgroundColor: 'transparent'\n  },\n  name: {\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    padding: `0 ${theme.spacing(1)}px`\n  },\n  logout: {\n    fontWeight: 'bold',\n    color: theme.palette.error.main\n  },\n  optionContainer: {\n    '& .MuiList-root': {\n      padding: 0\n    },\n    backgroundColor: theme.palette.grey[200],\n    borderBottomLeftRadius: theme.shape.borderRadius,\n    borderBottomRightRadius: theme.shape.borderRadius,\n    width: 150\n  },\n  option: {\n    borderTop: `1px solid ${theme.palette.grey[300]}`\n  },\n  avatar: {\n    width: 40,\n    height: 40\n  },\n  popper: {\n    zIndex: 1301\n  }\n}));\n\nfunction UserCard() {\n  const {\n    0: open,\n    1: setOpen\n  } = useState(false);\n  const anchorRef = useRef(null);\n  const classes = useStyles();\n  const viewer = useViewer();\n  const logout = useLogout();\n\n  if (!viewer) {\n    return null;\n  }\n\n  const handleToggle = () => {\n    setOpen(prevOpen => !prevOpen);\n  };\n\n  const handleClose = event => {\n    if (anchorRef.current.contains(event.target)) {\n      return;\n    }\n\n    setOpen(false);\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"button\", {\n    className: classes.card,\n    type: \"button\",\n    ref: anchorRef,\n    \"aria-controls\": open ? 'menu-list-grow' : undefined,\n    \"aria-haspopup\": \"true\",\n    onClick: handleToggle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }\n  }, __jsx(Avatar, {\n    classes: {\n      picture: classes.avatar\n    },\n    user: viewer,\n    withName: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }\n  }), open ? __jsx(ExpandLess, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 17\n    }\n  }) : __jsx(ExpandMore, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 34\n    }\n  })), __jsx(Popper, {\n    open: open,\n    anchorEl: anchorRef.current,\n    transition: true,\n    placement: \"bottom-start\",\n    className: classes.popper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }\n  }, ({\n    TransitionProps\n  }) => __jsx(Grow, _extends({}, TransitionProps, {\n    style: {\n      transformOrigin: 'top'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 11\n    }\n  }), __jsx(\"div\", {\n    className: classes.optionContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }\n  }, __jsx(ClickAwayListener, {\n    onClickAway: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 15\n    }\n  }, __jsx(MenuList, {\n    autoFocusItem: open,\n    id: \"menu-list-grow\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 17\n    }\n  }, __jsx(MenuItemLink, {\n    className: classes.option,\n    onClick: handleClose,\n    href: \"/user/[params]\",\n    as: `/user/${viewer.id}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 19\n    }\n  }, \"Profile\"), __jsx(MenuItemLink, {\n    className: classes.option,\n    onClick: handleClose,\n    href: \"/settings/[params]\",\n    as: `/settings/${viewer.id}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 19\n    }\n  }, \"Settings\"), __jsx(MenuItem, {\n    className: clsx(classes.option, classes.logout),\n    onClick: logout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 19\n    }\n  }, \"Sign out\")))))));\n}\n\nexport default UserCard;","map":{"version":3,"sources":["/Users/bibo/delivery/EIP/c3pm/platform/components/Layout/Header/RightNav/UserCard/index.tsx"],"names":["React","useRef","useState","clsx","Popper","Grow","ClickAwayListener","MenuList","MenuItem","ExpandMore","ExpandLess","makeStyles","useLogout","useViewer","MenuItemLink","Avatar","useStyles","theme","card","cursor","border","display","alignItems","padding","paddingRight","outline","backgroundColor","name","whiteSpace","overflow","textOverflow","spacing","logout","fontWeight","color","palette","error","main","optionContainer","grey","borderBottomLeftRadius","shape","borderRadius","borderBottomRightRadius","width","option","borderTop","avatar","height","popper","zIndex","UserCard","open","setOpen","anchorRef","classes","viewer","handleToggle","prevOpen","handleClose","event","current","contains","target","undefined","picture","TransitionProps","transformOrigin","id"],"mappings":"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","sourcesContent":["import React, { useRef, useState } from 'react';\nimport clsx from 'clsx';\nimport Popper from '@material-ui/core/Popper';\nimport Grow from '@material-ui/core/Grow';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport MenuList from '@material-ui/core/MenuList';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport ExpandMore from '@material-ui/icons/ExpandMore';\nimport ExpandLess from '@material-ui/icons/ExpandLess';\nimport makeStyles from '@material-ui/core/styles/makeStyles';\nimport { useLogout, useViewer } from 'hooks/auth';\n\nimport MenuItemLink from 'components/Layout/Header/RightNav/UserCard/MenuItemLink';\nimport Avatar from 'components/Avatar';\n\nconst useStyles = makeStyles((theme) => ({\n  card: {\n    cursor: 'pointer',\n    border: 'none',\n    display: 'flex',\n    alignItems: 'center',\n    padding: 6,\n    paddingRight: 0,\n    outline: 'none',\n    backgroundColor: 'transparent',\n  },\n  name: {\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    padding: `0 ${theme.spacing(1)}px`,\n  },\n  logout: {\n    fontWeight: 'bold',\n    color: theme.palette.error.main,\n  },\n  optionContainer: {\n    '& .MuiList-root': {\n      padding: 0,\n    },\n    backgroundColor: theme.palette.grey[200],\n    borderBottomLeftRadius: theme.shape.borderRadius,\n    borderBottomRightRadius: theme.shape.borderRadius,\n    width: 150,\n  },\n  option: {\n    borderTop: `1px solid ${theme.palette.grey[300]}`,\n  },\n  avatar: {\n    width: 40,\n    height: 40,\n  },\n  popper: {\n    zIndex: 1301,\n  },\n}));\n\nfunction UserCard(): JSX.Element {\n  const [open, setOpen] = useState(false);\n  const anchorRef = useRef(null);\n  const classes = useStyles();\n  const viewer = useViewer();\n  const logout = useLogout();\n\n  if (!viewer) {\n    return null;\n  }\n\n  const handleToggle = (): void => {\n    setOpen((prevOpen) => !prevOpen);\n  };\n\n  const handleClose = (event: React.MouseEvent<HTMLLIElement | Document, MouseEvent>): void => {\n    if (anchorRef.current.contains(event.target)) {\n      return;\n    }\n\n    setOpen(false);\n  };\n\n  return (\n    <>\n      <button\n        className={classes.card}\n        type=\"button\"\n        ref={anchorRef}\n        aria-controls={open ? 'menu-list-grow' : undefined}\n        aria-haspopup=\"true\"\n        onClick={handleToggle}\n      >\n        <Avatar\n          classes={{ picture: classes.avatar }}\n          user={viewer}\n          withName={false}\n        />\n        {open ? <ExpandLess /> : <ExpandMore />}\n      </button>\n      <Popper\n        open={open}\n        anchorEl={anchorRef.current}\n        transition\n        placement=\"bottom-start\"\n        className={classes.popper}\n      >\n        {({ TransitionProps }): JSX.Element => (\n          <Grow\n            {...TransitionProps}\n            style={{ transformOrigin: 'top' }}\n          >\n            <div className={classes.optionContainer}>\n              <ClickAwayListener onClickAway={handleClose}>\n                <MenuList autoFocusItem={open} id=\"menu-list-grow\">\n                  <MenuItemLink\n                    className={classes.option}\n                    onClick={handleClose}\n                    href=\"/user/[params]\"\n                    as={`/user/${viewer.id}`}\n                  >\n                    Profile\n                  </MenuItemLink>\n                  <MenuItemLink\n                    className={classes.option}\n                    onClick={handleClose}\n                    href=\"/settings/[params]\"\n                    as={`/settings/${viewer.id}`}\n                  >\n                    Settings\n                  </MenuItemLink>\n                  <MenuItem\n                    className={clsx(classes.option, classes.logout)}\n                    onClick={logout}\n                  >\n                    Sign out\n                  </MenuItem>\n                </MenuList>\n              </ClickAwayListener>\n            </div>\n          </Grow>\n        )}\n      </Popper>\n    </>\n  );\n}\n\nexport default UserCard;\n"]},"metadata":{},"sourceType":"module"}