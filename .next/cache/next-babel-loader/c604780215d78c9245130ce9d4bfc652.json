{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\n\nvar _jsxFileName = \"/Users/bibo/delivery/EIP/c3pm/platform/components/Layout/Header/RightNav/UserCard/index.tsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useRef, useState } from 'react';\nimport clsx from 'clsx';\nimport Popper from '@material-ui/core/Popper';\nimport Grow from '@material-ui/core/Grow';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport MenuList from '@material-ui/core/MenuList';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport ExpandMore from '@material-ui/icons/ExpandMore';\nimport ExpandLess from '@material-ui/icons/ExpandLess';\nimport makeStyles from '@material-ui/core/styles/makeStyles';\nimport { useLogout, useViewer } from 'hooks/auth';\nimport MenuItemLink from 'components/Layout/Header/RightNav/UserCard/MenuItemLink';\nimport Avatar from 'components/Avatar';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    card: {\n      cursor: 'pointer',\n      border: 'none',\n      display: 'flex',\n      alignItems: 'center',\n      padding: 6,\n      paddingRight: 0,\n      outline: 'none',\n      backgroundColor: 'transparent'\n    },\n    name: {\n      whiteSpace: 'nowrap',\n      overflow: 'hidden',\n      textOverflow: 'ellipsis',\n      padding: \"0 \".concat(theme.spacing(1), \"px\")\n    },\n    logout: {\n      fontWeight: 'bold',\n      color: theme.palette.error.main\n    },\n    optionContainer: {\n      '& .MuiList-root': {\n        padding: 0\n      },\n      backgroundColor: theme.palette.grey[200],\n      borderBottomLeftRadius: theme.shape.borderRadius,\n      borderBottomRightRadius: theme.shape.borderRadius,\n      width: 150\n    },\n    option: {\n      borderTop: \"1px solid \".concat(theme.palette.grey[300])\n    },\n    avatar: {\n      width: 40,\n      height: 40\n    },\n    popper: {\n      zIndex: 1301\n    }\n  };\n});\n\nfunction UserCard() {\n  _s();\n\n  var _this = this;\n\n  var _useState = useState(false),\n      open = _useState[0],\n      setOpen = _useState[1];\n\n  var anchorRef = useRef(null);\n  var classes = useStyles();\n  var viewer = useViewer();\n  var logout = useLogout();\n\n  if (!viewer) {\n    return null;\n  }\n\n  var handleToggle = function handleToggle() {\n    setOpen(function (prevOpen) {\n      return !prevOpen;\n    });\n  };\n\n  var handleClose = function handleClose(event) {\n    if (anchorRef.current.contains(event.target)) {\n      return;\n    }\n\n    setOpen(false);\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"button\", {\n    className: classes.card,\n    type: \"button\",\n    ref: anchorRef,\n    \"aria-controls\": open ? 'menu-list-grow' : undefined,\n    \"aria-haspopup\": \"true\",\n    onClick: handleToggle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }\n  }, __jsx(Avatar, {\n    classes: {\n      picture: classes.avatar\n    },\n    user: viewer,\n    withName: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }\n  }), open ? __jsx(ExpandLess, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 17\n    }\n  }) : __jsx(ExpandMore, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 34\n    }\n  })), __jsx(Popper, {\n    open: open,\n    anchorEl: anchorRef.current,\n    transition: true,\n    placement: \"bottom-start\",\n    className: classes.popper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }\n  }, function (_ref) {\n    var TransitionProps = _ref.TransitionProps;\n    return __jsx(Grow, _extends({}, TransitionProps, {\n      style: {\n        transformOrigin: 'top'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }\n    }), __jsx(\"div\", {\n      className: classes.optionContainer,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 13\n      }\n    }, __jsx(ClickAwayListener, {\n      onClickAway: handleClose,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 15\n      }\n    }, __jsx(MenuList, {\n      autoFocusItem: open,\n      id: \"menu-list-grow\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }\n    }, __jsx(MenuItemLink, {\n      className: classes.option,\n      onClick: handleClose,\n      href: \"/user/[params]\",\n      as: \"/user/\".concat(viewer.id),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 19\n      }\n    }, \"Profile\"), __jsx(MenuItemLink, {\n      className: classes.option,\n      onClick: handleClose,\n      href: \"/settings/[id]\",\n      as: \"/settings/\".concat(viewer.id),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 19\n      }\n    }, \"Settings\"), __jsx(MenuItem, {\n      className: clsx(classes.option, classes.logout),\n      onClick: logout,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 19\n      }\n    }, \"Sign out\")))));\n  }));\n}\n\n_s(UserCard, \"0dkI73pezjrKxV/VGmowVSJaCP4=\", false, function () {\n  return [useStyles, useViewer, useLogout];\n});\n\n_c = UserCard;\nexport default UserCard;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserCard\");","map":{"version":3,"sources":["/Users/bibo/delivery/EIP/c3pm/platform/components/Layout/Header/RightNav/UserCard/index.tsx"],"names":["React","useRef","useState","clsx","Popper","Grow","ClickAwayListener","MenuList","MenuItem","ExpandMore","ExpandLess","makeStyles","useLogout","useViewer","MenuItemLink","Avatar","useStyles","theme","card","cursor","border","display","alignItems","padding","paddingRight","outline","backgroundColor","name","whiteSpace","overflow","textOverflow","spacing","logout","fontWeight","color","palette","error","main","optionContainer","grey","borderBottomLeftRadius","shape","borderRadius","borderBottomRightRadius","width","option","borderTop","avatar","height","popper","zIndex","UserCard","open","setOpen","anchorRef","classes","viewer","handleToggle","prevOpen","handleClose","event","current","contains","target","undefined","picture","TransitionProps","transformOrigin","id"],"mappings":"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","sourcesContent":["import React, { useRef, useState } from 'react';\nimport clsx from 'clsx';\nimport Popper from '@material-ui/core/Popper';\nimport Grow from '@material-ui/core/Grow';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport MenuList from '@material-ui/core/MenuList';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport ExpandMore from '@material-ui/icons/ExpandMore';\nimport ExpandLess from '@material-ui/icons/ExpandLess';\nimport makeStyles from '@material-ui/core/styles/makeStyles';\nimport { useLogout, useViewer } from 'hooks/auth';\n\nimport MenuItemLink from 'components/Layout/Header/RightNav/UserCard/MenuItemLink';\nimport Avatar from 'components/Avatar';\n\nconst useStyles = makeStyles((theme) => ({\n  card: {\n    cursor: 'pointer',\n    border: 'none',\n    display: 'flex',\n    alignItems: 'center',\n    padding: 6,\n    paddingRight: 0,\n    outline: 'none',\n    backgroundColor: 'transparent',\n  },\n  name: {\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    padding: `0 ${theme.spacing(1)}px`,\n  },\n  logout: {\n    fontWeight: 'bold',\n    color: theme.palette.error.main,\n  },\n  optionContainer: {\n    '& .MuiList-root': {\n      padding: 0,\n    },\n    backgroundColor: theme.palette.grey[200],\n    borderBottomLeftRadius: theme.shape.borderRadius,\n    borderBottomRightRadius: theme.shape.borderRadius,\n    width: 150,\n  },\n  option: {\n    borderTop: `1px solid ${theme.palette.grey[300]}`,\n  },\n  avatar: {\n    width: 40,\n    height: 40,\n  },\n  popper: {\n    zIndex: 1301,\n  },\n}));\n\nfunction UserCard(): JSX.Element {\n  const [open, setOpen] = useState(false);\n  const anchorRef = useRef(null);\n  const classes = useStyles();\n  const viewer = useViewer();\n  const logout = useLogout();\n\n  if (!viewer) {\n    return null;\n  }\n\n  const handleToggle = (): void => {\n    setOpen((prevOpen) => !prevOpen);\n  };\n\n  const handleClose = (event: React.MouseEvent<HTMLLIElement | Document, MouseEvent>): void => {\n    if (anchorRef.current.contains(event.target)) {\n      return;\n    }\n\n    setOpen(false);\n  };\n\n  return (\n    <>\n      <button\n        className={classes.card}\n        type=\"button\"\n        ref={anchorRef}\n        aria-controls={open ? 'menu-list-grow' : undefined}\n        aria-haspopup=\"true\"\n        onClick={handleToggle}\n      >\n        <Avatar\n          classes={{ picture: classes.avatar }}\n          user={viewer}\n          withName={false}\n        />\n        {open ? <ExpandLess /> : <ExpandMore />}\n      </button>\n      <Popper\n        open={open}\n        anchorEl={anchorRef.current}\n        transition\n        placement=\"bottom-start\"\n        className={classes.popper}\n      >\n        {({ TransitionProps }): JSX.Element => (\n          <Grow\n            {...TransitionProps}\n            style={{ transformOrigin: 'top' }}\n          >\n            <div className={classes.optionContainer}>\n              <ClickAwayListener onClickAway={handleClose}>\n                <MenuList autoFocusItem={open} id=\"menu-list-grow\">\n                  <MenuItemLink\n                    className={classes.option}\n                    onClick={handleClose}\n                    href=\"/user/[params]\"\n                    as={`/user/${viewer.id}`}\n                  >\n                    Profile\n                  </MenuItemLink>\n                  <MenuItemLink\n                    className={classes.option}\n                    onClick={handleClose}\n                    href=\"/settings/[id]\"\n                    as={`/settings/${viewer.id}`}\n                  >\n                    Settings\n                  </MenuItemLink>\n                  <MenuItem\n                    className={clsx(classes.option, classes.logout)}\n                    onClick={logout}\n                  >\n                    Sign out\n                  </MenuItem>\n                </MenuList>\n              </ClickAwayListener>\n            </div>\n          </Grow>\n        )}\n      </Popper>\n    </>\n  );\n}\n\nexport default UserCard;\n"]},"metadata":{},"sourceType":"module"}